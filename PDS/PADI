         MACRO
&NAME    PADI  &A,&DA,&ZERO
         COPY  SYSGBL
         LCLA  &LA,&LDA
         SPLIT &A
&LA      SETA  &OL
         AIF   ('&ZERO'  NE '').LEAVEZE
         AIF   (&PADI).NODC
&PADI    SETB  1
         B     *+20
PADIWORK DC    CL16' '
.NODC    SPLIT &DA
&LDA     SETA  2*&OL
&NAME    MVC   PADIWORK(16),=CL16' '
 MVC PADIWORK+16-&LDA.(&LDA),=X'40202020202020202020202020202020'
 AIF ('&LDA' EQ '2' ).SKIP
 MVI PADIWORK+14,X'21'
.SKIP ANOP
 ED PADIWORK+16-&LDA.(&LDA),&O
 MVC &A,PADIWORK+16-&LA
 MEXIT
.LEAVEZE ANOP
&NAME UNPK &A,&DA
 LA 1,&O  PER INDIRIZZAMENTO INDIRETTO
 LA 1,&LA-1(1)
 OI 0(1),X'F0'  TOGLI IL SEGNO
 MEND
